
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loyal RolePlay</title>
<link rel="icon" type="image/png" href="logo.png">

<style>
body { margin:0; font-family: Arial,sans-serif; background: radial-gradient(circle at center,#1c2238,#0e1324 70%); color:white; overflow-x:hidden; }

.hidden { display:none !important; }

#loadingScreen {
  position: fixed;
  top:0; left:0; width:100%; height:100%;
  background: linear-gradient(135deg, #1c2238, #0e1324);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:99999;
  color:white;
  font-size:24px;
  font-weight:bold;
  letter-spacing:2px;
}
.loader-text { animation: pulse 1.5s infinite; }
@keyframes pulse { 0%, 100% { opacity:1; } 50% { opacity:0.5; } }

.sidebar { position: fixed; left:0; top:0; height:100%; width:180px; background:#1f2a41; padding-top:35px; text-align:center; z-index:50; }
.sidebar-logo { width:50px; display:block; margin:0 auto; }
.sidebar-title { font-size:20px; margin-top:10px; margin-bottom:20px; color:white; }
.nav-item { padding:12px 20px; color:#c4c9d6; text-decoration:none; display:block; text-align:left; transition:.2s; }
.nav-item:hover { background: rgba(255,255,255,0.05); color:white; }

.content { margin-left:180px; padding:60px 40px 40px 40px; }
.cards { display:grid; grid-template-columns: repeat(auto-fit,minmax(300px,1fr)); gap:25px; margin-top:60px; }

.profile { position: fixed; top:18px; right:20px; display:flex; align-items:center; cursor:pointer; z-index:9999; }
.profile img { width:60px; height:60px; border-radius:50%; object-fit:cover; margin-right:12px; border:2px solid #1a74ff; }
.profile span { font-weight:bold; color:white; font-size:18px; }

.profile-card { position:fixed; top:90px; right:20px; background: rgba(255,255,255,0.08); padding:20px; border-radius:12px; width:300px; box-shadow:0 0 20px rgba(0,0,0,0.4); backdrop-filter:blur(6px); z-index:1000; }
.profile-card img { width:80px; height:80px; border-radius:50%; margin-bottom:10px; border:2px solid #1a74ff; }
.profile-card input { width:100%; padding:10px; margin-bottom:10px; border-radius:6px; border:none; background: rgba(255,255,255,0.1); color:white; }
.profile-card input[disabled] { background: rgba(255,255,255,0.05); color:#b3b8c7; }
.profile-card button { width:100%; padding:12px; border:none; border-radius:6px; background:#1a74ff; font-weight:bold; cursor:pointer; color:white; margin-bottom:5px; }
.profile-card button:hover { background:#0f5cd4; }

.auth-popup { display:flex; justify-content:flex-start; align-items:flex-start; position:fixed; top:0; left:0; width:100%; height:100%; background: url('background.png') no-repeat center center/cover; backdrop-filter:blur(4px); z-index:2000; }
.auth-box { background: rgba(30,34,55,0.85); padding:40px 30px; border-radius:16px; width:350px; margin:40px; text-align:center; color:#fff; animation:fadeIn 0.3s ease; }
.auth-box h2 { margin:10px 0; font-size:26px; color:#1a74ff; }
.auth-box p { margin-bottom:20px; color:#c4c9d6; font-size:16px; }
.auth-box input { width:100%; padding:12px; margin-bottom:12px; border-radius:8px; border:none; background: rgba(255,255,255,0.12); color:white; font-size:15px; }
.auth-box button { width:100%; padding:12px; border:none; border-radius:8px; background:#1a74ff; font-weight:bold; cursor:pointer; color:white; font-size:15px; }
.auth-box button:hover { background:#0f5cd4; }
.auth-box #switchMode { margin-top:15px; cursor:pointer; color:#1a74ff; text-decoration:underline; }

.card { background: rgba(255,255,255,0.05); padding:25px; border-radius:12px; backdrop-filter:blur(8px); box-shadow:0 0 15px rgba(0,0,0,0.35); text-align:center; }
.card h2 { margin:0 0 10px 0; font-size:22px; color:white; }
.card p { margin:0; line-height:1.5; color:#c4c9d6; }
.card button { margin-top:12px; padding:10px 15px; border:none; border-radius:6px; background:#1a74ff; color:white; font-weight:bold; cursor:pointer; }
.card button:hover { background:#0f5cd4; }

@keyframes fadeIn { 0%{opacity:0; transform:translateY(-20px);} 100%{opacity:1; transform:translateY(0);} }
@keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.5;} }
</style>
</head>
<body>

<div id="loadingScreen"><div class="loader-text">Loading Loyal RolePlay...</div></div>

<div class="sidebar hidden" id="sidebar">
  <img src="logo.png" class="sidebar-logo">
  <div class="sidebar-title">Loyal RolePlay</div>
<a class="nav-item" href="/dashboard">Dashboard</a>
<a class="nav-item" href="/updates">Updates</a>
<a class="nav-item" href="/support">Support</a>

</div>

<div class="content hidden" id="mainContent">
  <div class="cards">
    <div class="card" id="discordCard">
      <h2>Discord</h2>
      <p>Join our Discord server: <b>Loyal RolePlay</b></p>
      <button onclick="window.open('https://discord.gg/EXEMPLU','_blank')">Join</button>
    </div>
    <div class="card" id="updatesCard">
      <h2>Latest Updates</h2>
      <p>Check out the latest news and updates on <a href="update.html" style="color:#1a74ff;">Update Page</a>.</p>
    </div>
  </div>
</div>

<div class="profile hidden" id="profileBtn">
  <img id="profileAvatar" src="">
  <span id="profileName"></span>
</div>

<div class="profile-card hidden" id="profileCard">
  <img id="cardAvatar" src="">
  <input type="text" id="cardDiscord" placeholder="Discord Name">
  <input type="text" id="cardEmail" placeholder="Email" disabled>
  <input type="text" id="cardUID" placeholder="User ID" disabled>
  <input type="text" id="cardAvatarURL" placeholder="Avatar URL">
  <button id="saveBtn">Save</button>
  <button id="logoutBtn">Logout</button>
</div>

<div class="auth-popup hidden" id="authPopup">
  <div class="auth-box">
    <h2 id="authTitle">Register</h2>
    <p>Loyal RolePlay</p>
    <input type="text" id="discordName" placeholder="Discord name (ex: Player#1234)">
    <input type="text" id="userID" placeholder="User ID">
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <input type="password" id="confirmPassword" placeholder="Confirm password">
    <button id="authBtn">Register</button>
    <p id="switchMode">Already have an account? Login</p>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
import { getDatabase, ref, set, get, update } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDuwtx8gFcD4nVPPR1Ej0qGZSDqskVrj48",
  authDomain: "PHXp-7ad68.firebaseapp.com",
  databaseURL: "https://PHXp-7ad68-default-rtdb.firebaseio.com",
  projectId: "PHXp-7ad68",
  storageBucket: "PHXp-7ad68.appspot.com",
  messagingSenderId: "958464426444",
  appId: "1:958464426444:web:4ddef0be7bf73a7f471d69",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getDatabase();

let isLogin = false;
const loadingScreen = document.getElementById('loadingScreen');

const hideAll = () => {
  document.getElementById("authPopup").classList.add("hidden");
  document.getElementById("sidebar").classList.add("hidden");
  document.getElementById("mainContent").classList.add("hidden");
  document.getElementById("profileBtn").classList.add("hidden");
  document.getElementById("profileCard").classList.add("hidden");
};

const showAuth = () => document.getElementById("authPopup").classList.remove("hidden");
const showContent = () => {
  document.getElementById("sidebar").classList.remove("hidden");
  document.getElementById("mainContent").classList.remove("hidden");
  document.getElementById("profileBtn").classList.remove("hidden");
};

async function loadProfile(uid){
  const snapshot = await get(ref(db,'users/'+uid));
  if(snapshot.exists()){
    const data = snapshot.val();
    document.getElementById("profileName").textContent = data.discord || "No Name";
    document.getElementById("profileAvatar").src = data.avatar || "https://cdn.discordapp.com/attachments/1153942954650648657/1442168936501215283/NTc5MjQxMS5qcGc.png";
    document.getElementById("cardAvatar").src = data.avatar || "";
    document.getElementById("cardDiscord").value = data.discord || "";
    document.getElementById("cardEmail").value = data.email || "";
    document.getElementById("cardUID").value = data.uid || "";
    document.getElementById("cardAvatarURL").value = data.avatar || "";
  }
}

document.getElementById("saveBtn").onclick = async () => {
  const user = auth.currentUser;
  if(!user) return;
  const discord = document.getElementById("cardDiscord").value;
  const avatar = document.getElementById("cardAvatarURL").value;
  await update(ref(db,'users/'+user.uid),{discord:discord, avatar:avatar});
  loadProfile(user.uid);
  alert("Profile updated!");
}

document.getElementById("profileBtn").onclick = () => {
  document.getElementById("profileCard").classList.toggle("hidden");
}

document.getElementById("logoutBtn").onclick = async () => {
  await signOut(auth);
  document.getElementById("profileCard").classList.add("hidden");
  hideAll();
  showAuth();
}

onAuthStateChanged(auth, user => {
  loadingScreen.style.display = 'none';
  if(user){
    hideAll();
    showContent();
    loadProfile(user.uid);
  } else {
    hideAll();
    showAuth();
  }
});

document.getElementById("switchMode").onclick = () => {
  const title = document.getElementById("authTitle");
  const btn = document.getElementById("authBtn");
  const discordInput = document.getElementById("discordName");
  const uidInput = document.getElementById("userID");
  if(isLogin){
    title.textContent = "Register";
    btn.textContent = "Register";
    discordInput.style.display="block";
    uidInput.style.display="block";
    document.getElementById("switchMode").textContent = "Already have an account? Login";
    isLogin = false;
  } else {
    title.textContent = "Login";
    btn.textContent = "Login";
    discordInput.style.display="none";
    uidInput.style.display="none";
    document.getElementById("switchMode").textContent = "Don't have an account? Register";
    isLogin = true;
  }
};

document.getElementById("authBtn").onclick = async () => {
  const email = document.getElementById("email").value;
  const pass = document.getElementById("password").value;
  const discord = document.getElementById("discordName").value;
  const uidInput = document.getElementById("userID").value;
  const conf = document.getElementById("confirmPassword").value;

  if(!isLogin){
    if(pass !== conf) return alert("Passwords do not match!");
    try{
      const userCred = await createUserWithEmailAndPassword(auth,email,pass);
      await set(ref(db,'users/'+userCred.user.uid),{
        discord:discord,
        email:email,
        avatar:"https://cdn.discordapp.com/attachments/1153942954650648657/1442168936501215283/NTc5MjQxMS5qcGc.png",
        uid:uidInput
      });
      alert("Account created!");
    } catch(e){ alert(e.message); }
  } else {
    try{ await signInWithEmailAndPassword(auth,email,pass); } catch(e){ alert(e.message); }
  }
};
</script>

</body>



